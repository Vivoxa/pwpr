<h1 class='centre'>Reports</h1>
<div class="container" style='margin-top:30px'>
  <%= form_tag controller: :reports, action: :create do %>
      <div class="field centre">
        <%= select_tag "report", options_for_select(@reports), {:class => 'devise-lgn form-control', :prompt => 'Select Report'} %>
      </div>
      <div class="field centre">
        <%= select_tag "year", options_for_select(@years), {:class => 'devise-lgn form-control', onchange: "return yearChanged(this);", :prompt => 'Select Year'} %>
      </div>

      <div class="field centre">
        <%= label_tag('Select All') %>
        <%= check_box_tag 'selectAll', 1, checked = false, {onclick: "return checkAll();"} %>
      </div>
      <div class="centre-wide">
        <table class="table table-striped table-bordered">
          <thead>
          <tr>
            <th>Business</th>
            <th>Date last sent</th>
            <th>Send?</th>
          </tr>
          </thead>
          <tbody>

          <% @report_form_data.each do |report_form| %>
              <%= fields_for "businesses[#{report_form.business_id}]", report_form do |rf| %>
                  <tr>
                    <td><%= rf.label report_form.business_name %></td>
                    <% if report_form.date_last_sent %>
                        <td><%= label_tag report_form.date_last_sent %></td>
                    <% else %>
                        <td><%= label_tag 'Report not yet sent' %></td>
                    <% end %>
                    <% if report_form.email_contact_present %>
                        <td><%= rf.check_box :email %></td>
                    <% else %>
                        <td><%= label_tag 'Contact not present' %></td>
                    <% end %>
                  </tr>
              <% end %>
          <% end %>
          </tbody>
        </table>
      </div>
      <div class="actions centre">
        <%= submit_tag 'Email Report', class: 'btn btn-primary devise-btn' %>
      </div>
  <% end %>
</div>
